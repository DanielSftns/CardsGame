"use strict";function asyncGeneratorStep(e,t,n,r,o,a,c){try{var i=e[a](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(r,o)}function _asyncToGenerator(i){return function(){var e=this,c=arguments;return new Promise(function(t,n){var r=i.apply(e,c);function o(e){asyncGeneratorStep(r,t,n,o,a,"next",e)}function a(e){asyncGeneratorStep(r,t,n,o,a,"throw",e)}o(void 0)})}}var startGameButton=document.querySelector(".start-game"),addButtons=document.querySelectorAll(".add-button");addButtons.forEach(function(o){o.addEventListener("click",function(){o.style.display="none";var n=o.parentNode.querySelector(".config-checkbox");n.checked=!0,o.parentNode.querySelector(".actions .cancel").addEventListener("click",function(){o.style.display="block",n.checked=!1,resetConfigCard(o.parentNode)});var r=o.parentNode.querySelector(".actions .confirm");r.addEventListener("click",function(){var e,t;r.classList.contains("active")&&(e=o.parentNode.classList[1].slice(-1),addCardsInDeck(document.querySelector(".deck".concat(e)),{numberCards:(t=r.parentNode.parentNode).querySelector(".number-of-cards").value,suit:t.querySelector(".suit").textContent,cardInSuit:t.querySelector(".card-in-suit").textContent}),o.style.display="block",n.checked=!1,resetConfigCard(o.parentNode),r.classList.remove("active"))})})});var allCheckbox=document.querySelectorAll(".select-checkbox"),selects=document.querySelectorAll(".select");selects.forEach(function(t){t.addEventListener("click",function(e){allCheckbox.forEach(function(e){t.contains(e)?e.checked=!e.checked:e.checked=!1})})});var options=document.querySelectorAll(".option");options.forEach(function(n){n.addEventListener("click",function(e){var t=e.target.textContent;e.target.parentNode.parentNode.parentNode.querySelector(".title").textContent=t,checkConfigCard(n.parentNode.parentNode.parentNode.parentNode)})});var inputsNumber=document.querySelectorAll(".number-of-cards");inputsNumber.forEach(function(n){n.addEventListener("keyup",function(e){var t=e.target.value;e.target.value=Math.round(parseFloat(t)),52<e.target.value&&(e.target.value=52),checkConfigCard(n.parentNode)})}),startGameButton.addEventListener("click",function(){startGameButton.classList.contains("active")&&(document.querySelector(".game-area").classList.remove("mode-config"),ordenDecks(),document.querySelector(".config").style.display="none",document.body.style.minHeight="65em")});var cardsContainers=document.querySelectorAll(".deck"),decksDiscarded=document.querySelectorAll(".deckDiscarded"),animationRunning=!1;function getSpace(e){var t=e.indexOf("-")+1,n=e.indexOf(")");return parseInt(e.slice(t,n))}function getRandomIntInclusive(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}function ordenDeck(e){for(var t=e.querySelectorAll(".card"),n=5,r=0;r<t.length;r++)t[r].style.transform="translate(0px, -".concat(n,"px) rotateX(-70deg) rotateY(0deg) rotateZ(10deg)"),(t[r].style.zIndex=r)+1<40&&(n+=5)}function ordenDecks(){for(var e=0;e<cardsContainers.length;e++)for(var t=cardsContainers[e].querySelectorAll(".card"),n=5,r=0;r<t.length;r++)t[r].style.transform="translate(0px, -".concat(n,"px) rotateX(-70deg) rotateY(180deg) rotateZ(-10deg)"),(t[r].style.zIndex=r)+1<40&&(n+=5)}function ordenDeckDiscarded(e){var t,n,r,o,a=e.querySelectorAll(".card");0<=e.childElementCount-2?(n=(t=a[e.childElementCount-2]).style.zIndex,r=(r=getSpace(t.style.transform))<200?r:195,a[o=e.childElementCount-1].style.transition="none",a[o].style.top="0",a[o].style.zIndex="".concat(parseInt(n)+1),a[o].style.transform="translate(0px, -".concat(r+5,"px) rotateX(-70deg) rotateY(0deg) rotateZ(10deg)")):(a[0].style.transition="none",a[0].style.top="0",a[0].style.zIndex="0",a[0].style.transform="translate(0px, -5px) rotateX(-70deg) rotateY(0deg) rotateZ(10deg)")}function checkConfigCard(e){var t=e.querySelector(".actions .confirm"),n=e.querySelector(".number-of-cards").value,r=e.querySelector(".suit").textContent,o=e.querySelector(".card-in-suit").textContent;""!=n&&"Suit"!=r&&"Card in suit"!=o?t.classList.add("active"):t.classList.remove("active")}function checkStatusConfig(){var e=document.querySelector(".deck1"),t=document.querySelector(".deck2"),n=document.querySelector(".deck3");0==e.childElementCount||0==t.childElementCount||0==n.childElementCount?startGameButton.classList.remove("active"):startGameButton.classList.add("active")}function resetConfigCard(e){e.querySelector(".number-of-cards").value="1",e.querySelector(".suit").textContent="Suit",e.querySelector(".card-in-suit").textContent="Card in suit"}function addCardsInDeck(e,t){for(var n=t.numberCards,r=t.suit,o=t.cardInSuit,a=isNaN(parseInt(o))?o[0]:o,c=0;c<n;c++){var i=document.createElement("div");i.setAttribute("class","card"),i.innerHTML='\n\t\t\t\t<div class="front">\n\t\t\t\t\t<img src="./img/cards/'.concat(a).concat(r[0],'.png">\n\t\t\t\t</div>\n\t\t\t\t<div class="reverse"></div>\n\t\t'),e.appendChild(i)}ordenDeck(e),checkStatusConfig()}function uploadConfigurationFile(e){return _uploadConfigurationFile.apply(this,arguments)}function _uploadConfigurationFile(){return(_uploadConfigurationFile=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var n,r,o,a,c,i,l,d,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n=(n=(n=t.replace(/ /g,"")).replace(/\r?\n|\r/g," ")).toUpperCase(),r=(r=n.split("DECK")).filter(function(e){return e}),o=0;o<r.length;o++)if(r[o]=r[o].trim(),""!=r[o])for(a=r[o].split(" "),c=0;c<a.length;c++)i=a[c].split(","),l=3==i.length?i[0]:1,d=3==i.length?i[1]:i[0],s=3==i.length?i[2]:i[1],addCardsInDeck(document.querySelector(".deck".concat(o+1)),{numberCards:l,suit:s,cardInSuit:d});case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}cardsContainers.forEach(function(d){d.addEventListener("click",function(){var e,t,n,r,o,a,c,i,l;!animationRunning&&0<d.childElementCount&&(animationRunning=!0,t=getRandomIntInclusive(0,e=d.querySelectorAll(".card").length-1),n=d.querySelectorAll(".card")[t],o=(r=d.querySelectorAll(".card")[e]).innerHTML,a=n.innerHTML,n.innerHTML=o,r.innerHTML=a,c=d.classList[1].slice(-1),i=document.querySelector(".deckDiscarded".concat(c)),r.style.zIndex="100",(l=0)<i.childElementCount&&(l=getSpace(i.querySelectorAll(".card")[i.childElementCount-1].style.transform)),r.style.transition="all 1s ease",r.style.transform="rotateX(0deg) rotateY(0deg) rotateZ(0deg)",r.style.top="calc(-100% - ".concat(l,"px)"),setTimeout(function(){r.style.top="calc(-100% - ".concat(l,"px)"),setTimeout(function(){r.style.transform="rotateX(-70deg) rotateY(0deg) rotateZ(10deg)",setTimeout(function(){i.appendChild(r),ordenDeckDiscarded(i),animationRunning=!1},1e3)},200)},1e3))})}),document.querySelector(".btn-upload").addEventListener("click",function(){var r=document.querySelector("#fileConfiguration");r.click(),r.addEventListener("change",function(e){var t=r.files[0],n=new FileReader;n.onload=function(e){uploadConfigurationFile(e.target.result)},n.readAsText(t)})});