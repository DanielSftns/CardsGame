"use strict";function asyncGeneratorStep(e,t,n,r,a,c,o){try{var s=e[c](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function _asyncToGenerator(s){return function(){var e=this,o=arguments;return new Promise(function(t,n){var r=s.apply(e,o);function a(e){asyncGeneratorStep(r,t,n,a,c,"next",e)}function c(e){asyncGeneratorStep(r,t,n,a,c,"throw",e)}a(void 0)})}}var cardsContainers=document.querySelectorAll(".deck"),allCheckbox=document.querySelectorAll(".select-checkbox"),inputsNumber=document.querySelectorAll(".number-of-cards"),selects=document.querySelectorAll(".select"),options=document.querySelectorAll(".option"),addButtons=document.querySelectorAll(".add-button"),startGameButton=document.querySelector(".start-game"),decksDiscarded=document.querySelectorAll(".deckDiscarded"),animationRunning=!1,gameFinished=!1;function getRandomIntInclusive(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}function ordenDeck(e){for(var t=e.querySelectorAll(".card"),n=0;n<t.length;n++){var r=15*Math.random(),a=15*Math.random();t[n].style.webkitTransform="translate(".concat(r,"px, ").concat(a,"px) rotateY(0deg)"),t[n].style.transform="translate(".concat(r,"px, ").concat(a,"px) rotateY(0deg)")}}function ordenDecks(){for(var e=0;e<cardsContainers.length;e++)for(var t=cardsContainers[e].querySelectorAll(".card"),n=0;n<t.length;n++){var r=15*Math.random(),a=15*Math.random();t[n].style.webkitTransform="translate(".concat(r,"px, ").concat(a,"px) rotateY(-180deg)"),t[n].style.transform="translate(".concat(r,"px, ").concat(a,"px) rotateY(-180deg)")}}function ordenDeckDiscarded(e){var t,n,r,a,c,o=e.querySelectorAll(".card");0<=e.childElementCount-2?(o[e.childElementCount-2],o[t=e.childElementCount-1].style.transition="none",o[t].style.webkitTransform="translate3d(0,0,0)",o[t].style.transform="translate3d(0,0,0)",o[t].style.zIndex="".concat(t),o[t].style.position="absolute",n=10*Math.random(),r=10*Math.random(),o[t].style.lef="".concat(n,"px"),o[t].style.top="".concat(r,"px")):(o[0].style.transition="none",o[0].style.webkitTransform="translate3d(0,0,0)",o[0].style.transform="translate3d(0,0,0)",o[0].style.zIndex="0",o[0].style.position="absolute",a=10*Math.random(),c=10*Math.random(),o[0].style.left="".concat(a,"px"),o[0].style.top="".concat(c,"px"))}function checkConfigCard(e){var t=e.querySelector(".actions .confirm"),n=e.querySelector(".number-of-cards").value,r=e.querySelector(".suit").textContent,a=e.querySelector(".card-in-suit").textContent;""!=n&&"Suit"!=r&&"Card in suit"!=a?t.classList.add("active"):t.classList.remove("active")}function checkStatusConfig(){var e=document.querySelector(".deck1"),t=document.querySelector(".deck2"),n=document.querySelector(".deck3");1==e.childElementCount||1==t.childElementCount||1==n.childElementCount?startGameButton.classList.remove("active"):startGameButton.classList.add("active")}function resetConfigCard(e){e.querySelector(".number-of-cards").value="1",e.querySelector(".suit").textContent="Suit",e.querySelector(".card-in-suit").textContent="Card in suit"}function addCardsInDeck(e,t){for(var n=t.numberCards,r=t.suit,a=t.cardInSuit,c=isNaN(parseInt(a))?a[0]:a,o=0;o<n;o++){var s=document.createElement("div");s.setAttribute("class","card"),s.innerHTML='\n\t\t\t\t<div class="front">\n\t\t\t\t\t<img src="./img/cards/'.concat(c).concat(r[0],'.png">\n\t\t\t\t</div>\n\t\t\t\t<div class="reverse"></div>\n\t\t'),e.appendChild(s)}}function uploadConfigurationFile(e){for(var t=e.replace(/ /g,""),n=(n=(t=(t=t.replace(/\r?\n|\r/g," ")).toUpperCase()).split("DECK")).filter(function(e){return e}),r=0;r<n.length;r++)if(n[r]=n[r].trim(),""!=n[r])for(var a=n[r].split(" "),c=0;c<a.length;c++){var o=a[c].split(","),s=3==o.length?o[0]:1,l=3==o.length?o[1]:o[0],i=3==o.length?o[2]:o[1];addCardsInDeck(document.querySelector(".deck".concat(r+1)),{numberCards:s,suit:i,cardInSuit:l})}document.querySelector(".settings-view").style.display="none",document.querySelector(".home").style.display="none",document.querySelector(".game-area").style.display="grid",startGameButton.classList.add("active"),startGameButton.click()}function playDefaultGame(){return _playDefaultGame.apply(this,arguments)}function _playDefaultGame(){return(_playDefaultGame=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("./configuration.txt");case 2:return t=e.sent,e.next=5,t.text();case 5:uploadConfigurationFile(e.sent);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}document.querySelector(".button.play").addEventListener("click",function(){playDefaultGame()}),document.querySelector(".button.settings").addEventListener("click",function(){document.querySelector(".home").style.display="none",document.querySelector(".settings-view").style.display="flex"}),document.querySelector(".button.graphics").addEventListener("click",function(){document.querySelector(".settings-view").style.display="none",document.querySelector(".config").style.display="grid",document.querySelector(".game-area").style.display="grid"}),document.querySelector(".button.file").addEventListener("click",function(){var r=document.querySelector("#fileConfiguration");r.click(),r.addEventListener("change",function(e){var t=r.files[0],n=new FileReader;n.onload=function(e){uploadConfigurationFile(e.target.result)},n.readAsText(t)})}),addButtons.forEach(function(c){c.addEventListener("click",function(){c.style.display="none";var r=c.parentNode.querySelector(".config-checkbox");r.checked=!0,c.parentNode.querySelector(".actions .cancel").addEventListener("click",function(){c.style.display="block",r.checked=!1,resetConfigCard(c.parentNode)});var a=c.parentNode.querySelector(".actions .confirm");a.addEventListener("click",function(){var e,t,n;a.classList.contains("active")&&(e=c.parentNode.classList[1].slice(-1),addCardsInDeck(t=document.querySelector(".deck".concat(e)),{numberCards:(n=a.parentNode.parentNode).querySelector(".number-of-cards").value,suit:n.querySelector(".suit").textContent,cardInSuit:n.querySelector(".card-in-suit").textContent}),ordenDeck(t),checkStatusConfig(),c.style.display="block",r.checked=!1,resetConfigCard(c.parentNode),a.classList.remove("active"))})})}),selects.forEach(function(t){t.addEventListener("click",function(e){allCheckbox.forEach(function(e){t.contains(e)?e.checked=!e.checked:e.checked=!1})})}),options.forEach(function(n){n.addEventListener("click",function(e){var t=e.target.textContent;e.target.parentNode.parentNode.parentNode.querySelector(".title").textContent=t,checkConfigCard(n.parentNode.parentNode.parentNode.parentNode)})}),inputsNumber.forEach(function(n){n.addEventListener("keyup",function(e){var t=e.target.value;e.target.value=Math.round(parseFloat(t)),52<e.target.value&&(e.target.value=52),checkConfigCard(n.parentNode)})}),startGameButton.addEventListener("click",function(){startGameButton.classList.contains("active")&&(document.querySelector(".game-area").classList.remove("mode-config"),ordenDecks(),document.querySelector(".config").style.display="none",document.body.style.fontSize="13px",window.scrollTo(0,document.querySelectorAll(".deck")[0].offsetTop/2))}),cardsContainers.forEach(function(i){i.addEventListener("click",function(e){var t,n,r,a,c,o,s,l;!animationRunning&&1<i.childElementCount&&!e.target.classList.contains("select-button")&&!gameFinished?(animationRunning=!0,n=getRandomIntInclusive(0,t=i.querySelectorAll(".card").length-1),r=i.querySelectorAll(".card")[n],c=(a=i.querySelectorAll(".card")[t]).innerHTML,o=r.innerHTML,r.innerHTML=c,a.innerHTML=o,s=i.classList[1].slice(-1),l=document.querySelector(".deckDiscarded".concat(s)),a.style.zIndex="100",a.style.transition="all 0.6s ease",a.style.webkitTransform="rotateY(0deg)",a.style.transform="rotateY(0deg)",setTimeout(function(){a.style.top="calc(-100% - 2em)",setTimeout(function(){l.appendChild(a),ordenDeckDiscarded(l),animationRunning=!1},600)},800)):e.target.classList.contains("select-button")&&(0==document.querySelectorAll(".select-button.selected").length?(e.target.textContent="Selected",e.target.classList.add("selected"),gameFinished=!0):e.target.classList.contains("selected")&&(e.target.textContent="Select",e.target.classList.remove("selected"),gameFinished=!1))})});